<!DOCTYPE html>
<html lang="">
<!--
  Git-sha: 85924ff87520d7d0eca8fc2a241fc37a5c278334
-->




<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Grid Search</title>
  <link href='//fonts.googleapis.com/css?family=Open+Sans:400,600' rel='stylesheet' type='text/css'>
  <link rel="stylesheet" href="//maxcdn.bootstrapcdn.com/bootstrap/3.3.5/css/bootstrap.min.css">
  <link rel="stylesheet" href="../css/style.css">
  <link rel="stylesheet" href="../css/pygments-default.css">

  <script src="../js/vendor/modernizr-2.6.1-respond-1.1.0.min.js"></script>
  <script src="../js/vendor/jquery-1.8.0.min.js"></script>
  <script src="../js/layout-setup.js"></script>
  <script src="../js/collapsable-content.js"></script>
  <script src="//ajax.googleapis.com/ajax/libs/jquery/1.11.3/jquery.min.js"></script>
  <script src="//maxcdn.bootstrapcdn.com/bootstrap/3.3.5/js/bootstrap.min.js"></script>
  <script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
  ga('create', 'UA-67859892-1', 'auto');
  ga('send', 'pageview');
</script>

</head>

<body cz-shortcut-listen="true">
  <header>
    <nav class="navbar navbar-inverse navbar-fixed-top">
      <div class="container head-of-page">
        <div class="navbar-header">
          <div class="navbar-brand">
            <a href=".."><img src="../img/seahorse_logo.png" alt="deepsense.ai Seahorse"></a>
          </div>
          <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
        </div>
        <div id="navbar" class="collapse navbar-collapse">
          <ul class="nav navbar-nav">
            <li class=""><a href="..">Overview</a></li>
            <li class="editor-link"><a href="../getting_started.html">Getting Started</a></li>
            <li class="editor-link"><a href="../deployment.html">Deployment</a></li>
            <li class=" dropdown">
              <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">Examples<span class="caret"></span></a>
              <ul class="dropdown-menu">
                <li class=""><a href="../basic_examples.html">Basic Examples</a></li>
                <li role="separator" class="divider"></li>
                
                  <li class=""><a href="../casestudies/credit_card_client_defaults.html">Credit Card Client Defaults</a></li>
                
                  <li class=""><a href="../casestudies/income_predicting.html">Income Prediction</a></li>
                
                  <li class=""><a href="../casestudies/mushrooms.html">Mushrooms</a></li>
                
                  <li class=""><a href="../casestudies/text_message_spam_detection.html">Text Message Spam Detection</a></li>
                
                  <li class=""><a href="../casestudies/wine_properties.html">Wine Properties</a></li>
                
              </ul>
            </li>
            <li class=" dropdown">
              <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">Reference Guide<span class="caret"></span></a>
              <ul class="dropdown-menu">
                <li class=""><a href="../reference/server_mode.html">Server Mode</a></li>
                <li class=""><a href="../reference/external_cluster.html">Using External Cluster</a></li>
                <li class=""><a href="../reference/productionizing.html">Productionizing Workflows</a></li>
                <li class=""><a href="../operations.html">Operations</a></li>
                <li class=""><a href="../reference/data_sources.html">Data Sources</a></li>
                <li class=""><a href="../reference/sdk_user_guide.html">SDK User Guide</a></li>
                <li class=""><a href="../reference/release_notes.html">Release Notes</a></li>
                <li class=""><a href="../reference/migration_guide.html">Migration Guide</a></li>
              </ul>
            </li>
            <li><a href="https://deepsense.ai/contact">Contact Us</a></li>
          </ul>
        </div>
      </div>
    </nav>
  </header>

  
  <script src="../js/search.js"></script>
<div class="col-md-12 sidemenu-container">
  <ul class="sidemenu lvl-1">
    <li>
      <form class="text-center search-form">
        <span class="glyphicon glyphicon-search" aria-hidden="true"></span>
        <input id="search" type="search" name="search">
      </form>
    </li>
    <li class="menu-group"><a><strong>Input/Output</strong></a>
      <ul class="lvl-2">
        <li><a href="../operations/python_notebook.html">Python Notebook</a></li>
        <li><a href="../operations/r_notebook.html">R Notebook</a></li>
        <li><a href="../operations/read_dataframe.html">Read DataFrame</a></li>
        <li><a href="../operations/read_transformer.html">Read Transformer</a></li>
        <li><a href="../operations/write_dataframe.html">Write DataFrame</a></li>
        <li><a href="../operations/write_transformer.html">Write Transformer</a></li>
      </ul>
    </li>
    <li class="menu-group"><a><strong>Action</strong></a>
      <ul class="lvl-2">
        <li><a href="../operations/evaluate.html">Evaluate</a></li>
        <li><a href="../operations/fit.html">Fit</a></li>
        <li><a href="../operations/fit_plus_transform.html">Fit + Transform</a></li>
        <li><a href="../operations/transform.html">Transform</a></li>
      </ul>
    </li>
    <li class="menu-group"><a><strong>Set Operation</strong></a>
      <ul class="lvl-2">
        <li><a href="../operations/join.html">Join</a></li>
        <li><a href="../operations/split.html">Split</a></li>
        <li><a href="../operations/union.html">Union</a></li>
        <li><a href="../operations/sort.html">Sort</a></li>
        <li><a href="../operations/sql_combine.html">SQL Combine</a></li>
      </ul>
    </li>
    <li class="menu-group"><a><strong>Filtering</strong></a>
      <ul class="lvl-2">
        <li><a href="../operations/filter_columns.html">Filter Columns</a></li>
        <li><a href="../operations/filter_rows.html">Filter Rows</a></li>
        <li><a href="../operations/handle_missing_values.html">Handle Missing Values</a></li>
        <li><a href="../operations/projection.html">Projection</a></li>
      </ul>
    </li>
    <li class="menu-group"><a><strong>Transformation</strong></a>
      <ul class="lvl-2">
        <li class="menu-group"><a>Custom</a>
          <ul class="lvl-3">
            <li><a href="../operations/create_custom_transformer.html">Create Custom Transformer</a></li>
            <li class="menu-group"><a>SQL</a>
              <ul class="lvl-4">
                <li><a href="../operations/sql_column_transformation.html">SQL Column Transformation</a></li>
                <li><a href="../operations/sql_transformation.html">SQL Transformation</a></li>
              </ul>
            </li>
            <li class="menu-group"><a>Python</a>
              <ul class="lvl-4">
                <li><a href="../operations/python_column_transformation.html">Python Column Transformation</a></li>
                <li><a href="../operations/python_transformation.html">Python Transformation</a></li>
              </ul>
            </li>
            <li class="menu-group"><a>R</a>
              <ul class="lvl-4">
                <li><a href="../operations/r_column_transformation.html">R Column Transformation</a></li>
                <li><a href="../operations/r_transformation.html">R Transformation</a></li>
              </ul>
            </li>
          </ul>
        </li>
        <li class="menu-group"><a>Feature Conversion</a>
          <ul class="lvl-3">
            <li><a href="../operations/assemble_vector.html">Assemble Vector</a></li>
            <li><a href="../operations/binarize.html">Binarize</a></li>
            <li><a href="../operations/compose_datetime.html">Compose Datetime</a></li>
            <li><a href="../operations/convert_type.html">Convert Type</a></li>
            <li><a href="../operations/dct.html">DCT</a></li>
            <li><a href="../operations/decompose_datetime.html">Decompose Datetime</a></li>
            <li><a href="../operations/get_from_vector.html">Get From Vector</a></li>
            <li><a href="../operations/normalize.html">Normalize</a></li>
            <li><a href="../operations/one_hot_encoder.html">One Hot Encoder</a></li>
            <li><a href="../operations/polynomial_expansion.html">Polynomial Expansion</a></li>
            <li><a href="../operations/quantile_discretizer.html">Quantile Discretizer</a></li>
            <li><a href="../operations/string_indexer.html">String Indexer</a></li>
            <li><a href="../operations/vector_indexer.html">Vector Indexer</a></li>
          </ul>
        </li>
        <li class="menu-group"><a>Feature Scaling</a>
          <ul class="lvl-3">
            <li><a href="../operations/min-max_scaler.html">Min-Max Scaler</a></li>
            <li><a href="../operations/standard_scaler.html">Standard Scaler</a></li>
          </ul>
        </li>
        <li class="menu-group"><a>Text Processing</a>
          <ul class="lvl-3">
            <li><a href="../operations/convert_to_n-grams.html">Convert to n-grams</a></li>
            <li><a href="../operations/count_vectorizer.html">Count Vectorizer</a></li>
            <li><a href="../operations/hashingtf.html">HashingTF</a></li>
            <li><a href="../operations/idf.html">IDF</a></li>
            <li><a href="../operations/remove_stop_words.html">Remove Stop Words</a></li>
            <li><a href="../operations/tokenize.html">Tokenize</a></li>
            <li><a href="../operations/tokenize_with_regex.html">Tokenize with Regex</a></li>
            <li><a href="../operations/word2vec.html">Word2Vec</a></li>
          </ul>
        </li>
      </ul>
    </li>
    <li class="menu-group"><a><strong>Machine Learning</strong></a>
      <ul class="lvl-2">
        <li class="menu-group"><a>Hyper Optimization</a>
          <ul class="lvl-3">
            <li><a href="../operations/grid_search.html">Grid Search</a></li>
          </ul>
        </li>
        <li class="menu-group"><a>Regression</a>
          <ul class="lvl-3">
            <li><a href="../operations/aft_survival_regression.html">AFT Survival Regression</a></li>
            <li><a href="../operations/decision_tree_regression.html">Decision Tree Regression</a></li>
            <li><a href="../operations/gbt_regression.html">GBT Regression</a></li>
            <li><a href="../operations/isotonic_regression.html">Isotonic Regression</a></li>
            <li><a href="../operations/linear_regression.html">Linear Regression</a></li>
            <li><a href="../operations/random_forest_regression.html">Random Forest Regression</a></li>
          </ul>
        </li>
        <li class="menu-group"><a>Classification</a>
          <ul class="lvl-3">
            <li><a href="../operations/decision_tree_classifier.html">Decision Tree Classifier</a></li>
            <li><a href="../operations/gbt_classifier.html">GBT Classifier</a></li>
            <li><a href="../operations/logistic_regression.html">Logistic Regression</a></li>
            <li><a href="../operations/multilayer_perceptron_classifier.html">Multilayer Perceptron Classifier</a></li>
            <li><a href="../operations/naive_bayes.html">Naive Bayes</a></li>
            <li><a href="../operations/random_forest_classifier.html">Random Forest Classifier</a></li>
          </ul>
        </li>
        <li class="menu-group"><a>Clustering</a>
          <ul class="lvl-3">
            <li><a href="../operations/k-means.html">K-Means</a></li>
            <li><a href="../operations/lda.html">LDA</a></li>
          </ul>
        </li>
        <li class="menu-group"><a>Feature Selection</a>
          <ul class="lvl-3">
            <li><a href="../operations/chi-squared_selector.html">Chi-Squared Selector</a></li>
          </ul>
        </li>
        <li class="menu-group"><a>Recommendation</a>
          <ul class="lvl-3">
            <li><a href="../operations/als.html">ALS</a></li>
          </ul>
        </li>
        <li class="menu-group"><a>Dimensionality Reduction</a>
          <ul class="lvl-3">
            <li><a href="../operations/pca.html">PCA</a></li>
          </ul>
        </li>
        <li class="menu-group"><a>Model Evaluation</a>
          <ul class="lvl-3">
            <li><a href="../operations/python_evaluator.html">Python Evaluator</a></li>
            <li><a href="../operations/r_evaluator.html">R Evaluator</a></li>
            <li><a href="../operations/binary_classification_evaluator.html">Binary Classification Evaluator</a></li>
            <li><a href="../operations/multiclass_classification_evaluator.html">Multiclass Classification Evaluator</a></li>
            <li><a href="../operations/regression_evaluator.html">Regression Evaluator</a></li>
          </ul>
        </li>
      </ul>
    </li>
  </ul>
</div>

  

  

  <div class="container" style="min-height: 100%;">

    <section style="padding-bottom: 100px;" class="documentation-content">
      
      <h1 class="title">Grid Search</h1>
      
      <p>The <code>Grid Search</code> is a powerful way to optimize the process of fitting
<a href="../classes/estimator.html">Estimators</a>.
Parameters that describe how the learning process should be performed are vital
to the quality of the resulting model. Unfortunately, it&#8217;s often difficult to guess
what the best values for them are.</p>

<p>The <code>Grid Search</code> operation allows us to specify a set of values for the parameters of the input
<code>Estimator</code>. The operation then goes through every combination of parameters from specified sets
and for each one the <code>Estimator</code> is fitted and the resulting trained model is evaluated
by means of cross validation.</p>

<p>The goal of <code>Grid Search</code> is to choose the best combination of parameters, where &#8220;best&#8221;
is defined as having received the highest grade from the <a href="../classes/evaluator.html">Evaluator</a>.</p>

<p>In order to grade a particular combination of parameters, the <code>Estimator</code> is fitted
<code>number of folds</code> times. In each &#8220;round&#8221; of training, the input dataset is divided
into training and test parts. The model fitted on the training data is used to score
the test part of the dataset. This score is evaluated and the final grade of the
parameter combination is the average score from all folds.</p>

<p>The result of the <code>Grid Search</code> operation is a <a href="../classes/report.html">Report</a> in which
every combination of parameters is graded by the <code>Evaluator</code>.</p>

<p>Parameters of the <code>Grid Search</code> operation mirror the parameters of its input <code>Estimator</code>, but some
of them accept multiple, comma-separated values. These special parameters are marked with
<img src="../img/grid_search_param_icon.png" />, as in the following example:</p>

<p><img class="img-responsive centered-image" src="../img/grid_search_00.png" /></p>

<p>Note that the <code>Grid Search</code> is an expensive operation. Selecting 5 values for 5 parameters results
in 25 models being cross validated.</p>

<p><strong>Since</strong>: Seahorse 1.0.0</p>

<h3 id="example">Example</h3>
<p>In the following case, the <code>Grid Search</code> operation is used to determine the best parameters
for training a <a href="random_forest_regression.html">Random Forest Regression</a> model.</p>

<p><code>number of folds</code> has to be at least <code>2</code>, but higher values make model evaluation more accurate.</p>

<p>In the <strong>PARAMETERS OF INPUT ESTIMATOR</strong> section of <code>Grid Search</code>&#8217;s parameters, we specify the parameter values.</p>

<p>Let&#8217;s set <code>max depth</code> to <code>10, 20, 30</code>, <code>max bins</code> to <code>32, 40, 50</code> and <code>num trees</code> to <code>10, 50, 100</code>.
This yields 27 distinct combinations of parameters.</p>

<p><img style="padding-top:20px; padding-bottom:30px" class="img-responsive centered-image" src="../img/grid_search_01.png" /></p>

<p>In the report below, every parameter combination is listed along with its grade.</p>

<p><img style="padding-top:40px" class="img-responsive centered-image" src="../img/grid_search_02.png" /></p>

<h2 id="input">Input</h2>

<table>
  <thead>
    <tr>
      <th style="width:20%">Port</th>
      <th style="width:25%">Type Qualifier</th>
      <th style="width:55%">Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>
        <code>0</code>
      </td>
      <td>
        <code>
          <a href="../classes/estimator.html">Estimator</a>
        </code>
      </td>
      <td>The <code>Estimator</code> to be fitted and evaluated.</td>
    </tr>
    <tr>
      <td>
        <code>1</code>
      </td>
      <td>
        <code>
          <a href="../classes/dataframe.html">DataFrame</a>
        </code>
      </td>
      <td>The <code>DataFrame</code> on which the estimator will be fitted and evaluated.</td>
    </tr>
    <tr>
      <td>
        <code>2</code>
      </td>
      <td>
        <code>
          <a href="../classes/evaluator.html">Evaluator</a>
        </code>
      </td>
      <td>The <code>Evaluator</code> that evaluates the fitted model.</td>
    </tr>
  </tbody>
</table>

<h2 id="output">Output</h2>

<table>
  <thead>
    <tr>
      <th style="width:20%">Port</th>
      <th style="width:25%">Type Qualifier</th>
      <th style="width:55%">Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>
        <code>0</code>
      </td>
      <td>
        <code>
          <a href="../classes/report.html">Report</a>
        </code>
      </td>
      <td>A <code>Report</code> about the search. Contains a score for every set of parameters that the search went through.</td>
    </tr>
  </tbody>
</table>

<h2 id="parameters">Parameters</h2>

<table class="table">
  <thead>
    <tr>
      <th style="width:20%">Name</th>
      <th style="width:25%">Type</th>
      <th style="width:55%">Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>
        <code>number of folds</code>
      </td>
      <td>
        <code><a href="../parameter_types.html#numeric">Numeric</a></code>
      </td>
      <td>
        A property of <code>Grid Search</code>'s internal cross validator.
        Describes how many times the input dataset should be partitioned into training and test datasets.
      </td>
    </tr>
  </tbody>
</table>

    </section>
  </div>

  <footer class="col-sm-12">
    <p class="text-center footer-text">Seahorse by <a href="https://deepsense.ai/" target="_blank"><span>deep</span>sense<span>.ai</span></a> | 2017 |
          <a target="_blank" href="https://twitter.com/deepsense_ai/"><img src="../img/twitter.png" height="35px"></a>
          <a target="_blank" href="https://github.com/deepsense-ai/seahorse"><img src="../img/octocat.png" height="25px"></a>
          <a target="_blank" href="https://community.seahorse.deepsense.ai/"><img src="../img/discourse.png" height="25px"></a>
    </p>
  </footer>
</body>

</html>
